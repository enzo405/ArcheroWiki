{% extends "template.html" %}
{% load static %}
{% block head %}
<meta charset="UTF-8">
<link rel="stylesheet" type="text/css" href="{% static 'calculator.css' %}?version=1.3.7">
<title>Archero - Wiki - Calculator</title>
<meta property="og:title" content="Archero Stats Calculator">
<meta property="og:url" content="https://stats.wiki-archero.com/calculator/index/">
<meta property="og:type" content="website">
<meta property="og:description" content="Welcome to Archero website! We offer advanced gameplay statistics, comprehensive guides to help you progress through the game. This site is constantly evolving and includes the latest updates.">
<meta name="description" content="Welcome to Archero website! We offer advanced gameplay statistics, comprehensive guides to help you progress through the game. This site is constantly evolving and includes the latest updates.">
<meta property="og:image" content="{% static 'image/archero_icon.png' %}?version=1.3.7">
{% endblock %}
{% block header_content %}{{ header_msg }}{% endblock %}
{% block content %}
<div class="main-index">
	<div class="div-table-index">
		{% if show_table == "no_profile" %}
		<div class="div_formulaire">
			<a href="/calculator/create/">Create profile</a>
		</div>
		{% elif show_table == "yes" or show_table == "no_show" %}
		<table class="index-table self-table">
			<thead class="table-header">
				<tr>
					<th>Username</th>
					<th class="self_table_atk_row">Attack</th>
					<th class="self_table_hp_row">Hp</th>
					{% if show_table != "no_show" %}
					<th>Show</th>
					{% endif %}
					<th>Update</th>
				</tr>
			</thead>
			<tbody class="table-content">
			<tr>
				<td id="td-table-stats-index">{{ self_ingame_name }}</td>
				<td id="td-table-stats-index" class="self_table_atk_row">{{ self_global_atk_save }}</td>
				<td id="td-table-stats-index" class="self_table_hp_row">{{ self_global_hp_save }}</td>
				{% if show_table != "no_show" %}
					<td id="td-table-stats-index"><a href='/calculator/show/{{ self_public_id }}/'><button class="btn-table">Show</button></a></td>
				{% endif %}
				<td id="td-table-stats-index"><a href='/calculator/update/{{ self_public_id }}/'><button class="btn-table">Update</button></a></td>
			</tr>
			</tbody>
		</table>
		{% elif show_table == "visitor" %}
			{% if try_access %}
				<script>
					createModale('You attempted to access {{ self_ingame_name }}<br>But your login username is "{{ ingame_name_cookie }}".<br>Admin have been warned',false)
				</script>
			{% endif %}
		<div class="div_formulaire">
			<a href="/login">Log-in</a>
		</div>
		<div class="help-index-msg">
			<p class="msg-index-no-profile">If you already have a profile, please contact me on <a href="https://discord.com/users/382930544385851392" target="_blank">Discord</a> or <a href="https://www.reddit.com/user/LuhCaran101" target="_blank">Reddit</a></p>
		</div>
		{% endif %}
		<div class="container_table_all">
			<table id="index-table" class="index-table overflow_index_table">
				<thead class="table-header">
					<tr>
						<th>Username</th>
						<th class="hero_row">Hero</th>
						<th class="table_atk_row">Attack</th>
						<th class="table_hp_row">Hp</th>
						<th>Show</th>
					</tr>
				</thead>
				<tbody class="table-content">
				{% for l in listALL %}
				<tr id="{{ l.ingame_name }}">
					<td id="td-table-stats-index">{{ l.ingame_name }}</td>
					<td id="td-table-stats-index" class="hero_row">{{ l.choosen_hero }}</td>
					<td id="td-table-stats-index" class="table_atk_row">{{ l.global_atk_save }}</td>
					<td id="td-table-stats-index" class="table_hp_row">{{ l.global_hp_save }}</td>
					<td id="td-table-stats-index"><a href='/calculator/show/{{ l.public_id }}/'><button class="btn-table">Show</button></a></td>
				</tr>
				{% endfor %}
				</tbody>
			</table>
		</div>
		<div id="pagination"></div>
	</div>
</div>
{% endblock %}
{% block javascript %}
<script>
	const self_inline_div_traveling = document.getElementById('Stats-sidebar-image')
	self_inline_div_traveling.classList.add('bg-traveling') 
</script>
<script>
	// SCRIPT MADE BY CHAT GPT (because to lazy :weary:)
	const table = document.querySelector("#index-table tbody");
	const rows = table.rows;
	const rowsPerPage = 18;
	const numPages = Math.ceil(rows.length / rowsPerPage);
	const pagination = document.querySelector("#pagination");

	for (let i = 0; i < numPages; i++) {
	const pageButton = document.createElement("button");
	pageButton.textContent = i + 1;
	pageButton.addEventListener("click", function () {
		showPage(i);
	});
	pagination.appendChild(pageButton);
	}

	function showPage(pageNum) {
	for (let i = 0; i < rows.length; i++) {
		rows[i].style.display = "none";
	}
	for (let i = pageNum * rowsPerPage; i < (pageNum + 1) * rowsPerPage; i++) {
		if (i < rows.length) {
		rows[i].style.display = "table-row";
		}
	}
	}

	showPage(0);
	pagination.firstChild.classList.add("active");

	pagination.addEventListener("click", function (event) {
  	if (event.target.tagName === "BUTTON") {
		const activeButton = pagination.querySelector("button.active");
		activeButton.classList.remove("active");
		event.target.classList.add("active");
	}});
</script>
{% endblock %}